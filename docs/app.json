[{"name":"app.R","content":"library(shiny)\r\nlibrary(shinydashboard)\r\nlibrary(openxlsx)\r\nlibrary(DT)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(tidyr)\r\n\r\n\r\n\r\nui <- dashboardPage(\r\n  dashboardHeader(title = \"Электронный журнал\",titleWidth = 500),\r\n  dashboardSidebar(width = 250,\r\n                   sidebarMenu(\r\n                     menuItem(\"Загрузка журнала\", tabName = \"upload\", icon = icon(\"file-import\")),\r\n                     menuItem(\"Журнал\", tabName = \"journal\", icon = icon(\"book-journal-whills\")),\r\n                     menuItem(\"Статистика\", tabName = \"table_stats\", icon = icon(\"chart-simple\")),\r\n                     menuItem(\"Графики\", tabName = \"plot_stats\", icon = icon(\"chart-area\")),\r\n                     menuItem(\"Помощь\", tabName = \"help\", icon = icon(\"circle-question\")),\r\n                     menuItem(\"О сайте\", tabName = \"about\", icon = icon(\"circle-info\"))\r\n                   )\r\n  ),\r\n  dashboardBody(\r\n    tags$head(\r\n      tags$link(rel = \"stylesheet\", href = \"custom.css\")\r\n    ),\r\n    tabItems(\r\n      tabItem(\r\n        tabName = \"upload\",\r\n        fileInput(\"upload\",\"Выберете файл для загрузки\", \r\n                  buttonLabel = \"Выберете файл\",\r\n                  width = 500,\r\n                  placeholder = \"Файл не найден\",\r\n                  accept = c(\".csv\",\".txt\",\".xmlx\")),\r\n        box( title = \"Просмотр содержимого\", \r\n             status = \"info\", \r\n             height = \"545\",\r\n             width = \"14\",\r\n             solidHeader = T, \r\n             column(width = 12,\r\n                    tableOutput(\"upload\"),\r\n                    style = \"height:485px; overflow-y: scroll;overflow-x: scroll;\")\r\n        )\r\n      ),\r\n      \r\n      tabItem(\r\n        tabName = \"journal\",\r\n        box( title = \"Журнал\", \r\n             status = \"info\", \r\n             height = \"545\",\r\n             width = \"14\",\r\n             solidHeader = T, \r\n             column(width = 12,\r\n                    dataTableOutput(\"journal\"),\r\n                    style = \"height:485px; overflow-y: scroll;overflow-x: scroll;\")\r\n        ),\r\n        actionButton(\"createusr\",\"Добавить ученика\"),\r\n        actionButton(\"deleteusr\",\"Удалить ученика\")\r\n      ),\r\n      \r\n      tabItem(\r\n        tabName = \"table_stats\",\r\n        tabsetPanel(\r\n          tabPanel(\"Статистика по классам\",\r\n                   DTOutput(\"class_subject_stats\")),\r\n          tabPanel(\"Статистика по предметам\",\r\n                   DTOutput(\"overall_subject_stats\"))\r\n        )                   \r\n      ),\r\n      \r\n      tabItem(\r\n        tabName = \"plot_stats\",\r\n        tabsetPanel(\r\n          tabPanel(\"Статистика по классам\",\r\n                   plotOutput(\"plot_class_subject\"), plotOutput(\"histogram_class_subject\")),\r\n          tabPanel(\"Статистика по предметам\",\r\n                   plotOutput(\"plot_overall_subject\"), plotOutput(\"histogram_overall_subject\"))\r\n        )     \r\n      ),\r\n      \r\n      tabItem(\r\n        tabName = \"help\",\r\n        box(title = \"Помощь\",\r\n            status = \"info\",\r\n            width = 15,\r\n            HTML(\"<p>Добро пожаловать в электронный журнал оценок,<\/p>\r\n            <p>Здесь вы можете загрузить и отредактировать журнал, а также посмотреть статистику учеников в удобной для вас форме<\/p>\r\n            <p>1. Для начала загрузите журнал во вкладке 'Загрузка журнала'<\/p>\r\n            <p>1.1. Для загрузки журнала, нажмите на кнопку 'Выберете файл', он должен иметь одно из таких расширений: #.xlsx #.csv #.txt<\/p>\r\n            <p>2. Для редактирования журнала зайдите во вкладку 'Журнал'<\/p>\r\n            <p>2.1. Для удаления ученика, нажмите на кнопку 'Удалить ученика'<\/p>\r\n            <p>2.2. Для добавления ученика, нажмите на кпоку 'Добавить ученика'<\/p>\r\n            <p>4. Для просмотра статистики в табличной форме перейдите во вкладку 'Статистика'<\/p>\r\n            <p>4.1. Для просмотра статистики по классам выберите вкладку 'Статистика по классам'<\/p>\r\n            <p>4.2. Для просмотра статистики по предметам выберите вкладку 'Статистика по предметам'<\/p>\r\n            <p>5. Для просмотра статистики в виде графика перейдите во вкладку 'График'<\/p>\r\n            <p>5.1. Для просмотра графика по классам выберите вкладку 'Статистика по классам'<\/p>\r\n            <p>5.2. Для просмотра графика по предметам выберите вкладку 'Статистика по предметам'<\/p>\r\n            <p>Во вкладке о сайте, содеражатся контакты автора приложения Shiny <\/p>\")\r\n        )\r\n      ),\r\n      \r\n      tabItem(\r\n        tabName = \"about\",\r\n        box(title = \"О разработчике\",\r\n            status = \"info\",\r\n            width = 15,\r\n            HTML(\"<p>Разработчик приложения Shiny<\/p>\r\n            <p>Малинин Матвей Эдуардович, студент СибГУТИ, по направлению 'Информационная безопасность', группа: АБ-110<\/p>\r\n            <p> Контактные данные:<\/p>\r\n            <p>1. VK: <a href='https://vk.com/malinin3009'>Вконтакте<\/a> <\/p>\r\n            <p>2. Telegram: <a href='https://postimages.org/' target='_blank'><img src='https://i.postimg.cc/cHSfRk7r/mj8-KU-rq-Xyg.jpg' border='0' alt='mj8-KU-rq-Xyg'/><\/a> <\/p>\r\n            <p>3. Номер телефона 8-999-450-**-**-.<\/p>\")\r\n        )\r\n      )\r\n    )\r\n  )\r\n)\r\n\r\n\r\n\r\nserver <- function(input, output){\r\n  \r\n  loadedData <- reactiveVal(NULL)\r\n  values <- reactiveValues(dfWorking = loadedData)\r\n  \r\n  observeEvent(input$upload,{\r\n    req(input$upload)\r\n    file <- input$upload\r\n    ext <- tools::file_ext(file$datapath)\r\n    if (ext == \"xlsx\"){\r\n      data <- read.xlsx(file$datapath) \r\n      loadedData(data)\r\n    }\r\n    else if(ext == \"csv\"){\r\n      data <- read.csv2(file$datapath)\r\n      loadedData(data)\r\n    }\r\n    else if(ext == \"txt\"){\r\n      data <- read.delim(file$datapath,sep = \"\\t\")\r\n      loadedData(data)\r\n    }\r\n    else{\r\n      loadedData(\"Загрузите файл .csv .txt .xlsx\")\r\n    }\r\n  })\r\n  \r\n  output$upload <- renderTable({\r\n    loadedData()\r\n  })\r\n  \r\n  output$journal <- renderDataTable({\r\n    datatable(loadedData(), \r\n              editable = list(target = 'cell', \r\n                              disable = list(columns = c(0))),\r\n              selection = \"single\",\r\n              options = list(language = list(search = \"Поиск\"))\r\n    )\r\n  })\r\n  \r\n  observeEvent(input$createusr,{\r\n    if(input$createusr){\r\n      loadedData(add_row(loadedData()))\r\n    }\r\n  })\r\n  \r\n  observeEvent(input$deleteusr, {\r\n    t = loadedData()\r\n    if (!is.null(input$journal_rows_selected)) {\r\n      t <- t[-as.numeric(input$journal_rows_selected),]\r\n    }\r\n    loadedData(t)\r\n  })\r\n  \r\n  observe({\r\n    if (!is.null(loadedData())) {\r\n      data_stats <- loadedData() %>%\r\n        gather(key = \"subject\", value = \"mark\", -c(name, class)) %>%\r\n        group_by(class, subject) %>%\r\n        summarize(\r\n          Среднее.значение = mean(mark),\r\n          Медиана = median(mark),\r\n          `2` = sum(mark == 2),\r\n          `3` = sum(mark == 3),\r\n          `4` = sum(mark == 4),\r\n          `5` = sum(mark == 5),\r\n          Всего = n()\r\n        ) %>%\r\n        mutate(across(`2`:`5`, ~sprintf(\"%d (%.1f%%)\", ., .*100/Всего)))\r\n      \r\n      output$class_subject_stats <- \r\n        renderDT(data_stats,\r\n                 editable = FALSE, \r\n                 selection = \"single\", \r\n                 escape = FALSE, \r\n                 options = list(language = list(search = \"Предмет\")))\r\n      \r\n      plot_class_subject <- ggplot(data_stats, aes(x = subject, y = Среднее.значение, fill = factor(class))) +\r\n        geom_bar(stat = \"identity\", position = \"dodge\",colour=\"black\",width = 0.5) +\r\n        labs(title = \"Статистика по классам\",\r\n             x = \"Предмет\",\r\n             y = \"Средняя оценка\") +\r\n        theme_grey()\r\n      \r\n      output$plot_class_subject <- renderPlot({\r\n        print(plot_class_subject)\r\n      })\r\n    }\r\n  })\r\n  \r\n  observe({\r\n    if (!is.null(loadedData())) {\r\n      data_stats <- loadedData() %>%\r\n        gather(key = \"subject\", value = \"mark\", -c(name, class))%>%\r\n        group_by(subject) %>%\r\n        summarize(\r\n          Среднее.значение = mean(mark),\r\n          Медиана = median(mark),\r\n          `2` = sum(mark == 2),\r\n          `3` = sum(mark == 3),\r\n          `4` = sum(mark == 4),\r\n          `5` = sum(mark == 5),\r\n          Всего = n()\r\n        ) %>%\r\n        mutate(across(`2`:`5`, ~sprintf(\"%d (%.1f%%)\", ., .*100/Всего)))\r\n      \r\n      output$overall_subject_stats <- \r\n        renderDT(data_stats,\r\n                 editable = FALSE, \r\n                 selection = \"single\", \r\n                 escape = FALSE, \r\n                 options = list(language = list(search = \"Предмет\")))\r\n      \r\n      plot_overall_subject <- ggplot(data_stats, aes(x = subject, y = Среднее.значение)) +\r\n        geom_bar(stat = \"identity\", fill = \"#BA55D3\",colour=\"black\",width = 0.1) +\r\n        labs(title = \"Статистика по предметам\",\r\n             x = \"Предмет\",\r\n             y = \"Средняя оценка\") +\r\n        theme_grey()\r\n      \r\n      output$plot_overall_subject <- renderPlot({\r\n        print(plot_overall_subject)\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"journal.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"},{"name":"www/custom.css","content":".main-header .logo{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 36px;\r\n  height: 50px;\r\n}\r\n\r\n.skin-blue .main-header .logo{\r\n  background-color: #BA55D3; /* MediumOrchid */\r\n  border-radius: 50px;\r\n}\r\n\r\n.skin-blue .main-header .logo:hover{\r\n  background-color: #BA55D3; /* MediumOrchid */\r\n  border-radius: 50px;\r\n}\r\n\r\n.skin-blue .main-header .navbar{\r\n  background-color:#232b2b; /* Charleston Green */\r\n}\r\n\r\n.skin-blue .main-header .navbar .sidebar-toggle:hover{\r\n  background-color:#555555; /* Davy’s grey */\r\n  height: 50px;\r\n}\r\n\r\n.skin-blue .main-sidebar{\r\n  background-color:#232b2b; /* Charleston Green */\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 20px;\r\n  top: 20px;\r\n}\r\n\r\n.skin-blue .main-sidebar, .skin-blue .wrapper{\r\n  background-color:#232b2b; /* Charleston Green */\r\n}\r\n\r\n.skin-blue .main-sidebar .sidebar .sidebar-menu .active a{\r\n  background-color:#555555; /* Davy’s grey */\r\n  border-radius: 50px;\r\n  border-left-color:#BA55D3; /* MediumOrchid */\r\n}\r\n\r\n.skin-blue .main-sidebar .sidebar .sidebar-menu a{\r\n  background-color:#232b2b; /* Charleston Green */\r\n  color:white;\r\n}\r\n\r\n.skin-blue .main-sidebar .sidebar .sidebar-menu a:hover{\r\n  background-color:#555555; /* Davy’s grey */\r\n  color:#232b2b; /* Charleston Green */\r\n  color:white;\r\n  border-radius: 50px;\r\n  border-left-color:#BA55D3; /* MediumOrchid */\r\n}\r\n\r\n.skin-blue .content-wrapper{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size:16px;\r\n  background-color:#808080 ; /* Trolley Grey */\r\n  border-top-left-radius: 10px;\r\n  position: relative;\r\n  top:20px;\r\n}\r\n\r\n.skin-blue .content-wrapper .content .tab-content .shiny-tab-upload .from-group .lablel{\r\n  font-weight: 100px;\r\n}\r\n#upload-label{\r\n  font-weight: 500;\r\n}\r\n\r\n#upload_progress{\r\n  background-color:#BA55D3; /* MediumOrchid */\r\n}\r\n\r\n#upload_progress .progress-bar{\r\n  background-color:#BA55D3; /* MediumOrchid */\r\n  \"Загрузка прошла успешно\";\r\n}\r\n\r\n#shiny-tab-upload .col-sm-14 .box-info{\r\n  border:2px solid #BA55D3; /* MediumOrchid */\r\n}\r\n\r\n#shiny-tab-upload .col-sm-14 .box-header{\r\n  background-color:#DA70D6; /* Orchid */\r\n}\r\n\r\n#shiny-tab-upload .col-sm-14 .box-body{\r\n  background-color:#d3d3d3; /* Light Grey */\r\n}\r\n\r\n#shiny-tab-upload .col-sm-14 .box-header  h3{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 20px;\r\n}\r\n\r\n#shiny-tab-journal .col-sm-14 .box-info{\r\n  border:2px solid #BA55D3; /* MediumOrchid */\r\n}\r\n\r\n#shiny-tab-journal .col-sm-14 .box-header{\r\n  background-color:#DA70D6; /* Orchid */\r\n}\r\n\r\n#shiny-tab-journal .col-sm-14 .box-body{\r\n  background-color:#d3d3d3; /* Light Grey */\r\n}\r\n\r\n#shiny-tab-journal .col-sm-14 .box-header  h3{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 20px;\r\n}\r\n\r\n#shiny-tab-table_stats{\r\n  background-color:#d3d3d3; /* Light Grey */\r\n  border-radius: 5px;\r\n}\r\n\r\n#shiny-tab-table_stats > div > ul{\r\n  background: #DA70D6;/* Orchid */\r\n}\r\n\r\n#shiny-tab-table_stats > div{\r\n  border:2px solid #BA55D3; /* MediumOrchid */\r\n}\r\n\r\n#shiny-tab-table_stats > div > ul > li:nth-child(1){\r\n  background-color: #DA70D6;/* Orchid */\r\n}\r\n\r\n#shiny-tab-table_stats > div > ul > li:nth-child(1) a{\r\n  color:#333;\r\n}\r\n\r\n#shiny-tab-table_stats > div > ul > li:nth-child(2){\r\n  background-color: #DA70D6;/* Orchid */\r\n}\r\n\r\n#shiny-tab-table_stats > div > ul > li:nth-child(2) a{\r\n  color:#333;\r\n}\r\n\r\n#shiny-tab-table_stats > div > div{\r\n  padding-left: 25px;\r\n  padding-top: 10px;\r\n}\r\n\r\n#shiny-tab-plot_stats > div > div{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 20px;\r\n}\r\n\r\n#shiny-tab-plot_stats > div > ul{\r\n  background: #DA70D6;/* Orchid */\r\n}\r\n\r\n#shiny-tab-plot_stats > div > ul > li:nth-child(1){\r\n  background-color: #DA70D6;/* Orchid */\r\n}\r\n\r\n#shiny-tab-plot_stats > div > ul > li:nth-child(1) a{\r\n  color:#333;\r\n}\r\n\r\n#shiny-tab-plot_stats > div > ul > li:nth-child(2){\r\n  background-color: #DA70D6;/* Orchid */\r\n}\r\n\r\n#shiny-tab-plot_stats > div > ul > li:nth-child(2) a{\r\n  color:#333;\r\n}\r\n\r\n#shiny-tab-help .col-sm-15 .box-info{\r\n  border:2px solid #BA55D3; /* MediumOrchid */\r\n}\r\n\r\n#shiny-tab-help .col-sm-15 .box-header{\r\n  background-color:#DA70D6; /* Orchid */\r\n}\r\n\r\n#shiny-tab-help .col-sm-15 .box-body{\r\n  background-color:#d3d3d3; /* Light Grey */\r\n}\r\n\r\n#shiny-tab-help .col-sm-15 .box-header  h3{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 20px;\r\n  color:white;\r\n}\r\n\r\n#shiny-tab-about .col-sm-15 .box-info{\r\n  border:2px solid #BA55D3; /* MediumOrchid */\r\n}\r\n\r\n#shiny-tab-about .col-sm-15 .box-header{\r\n  background-color:#DA70D6; /* Orchid */\r\n}\r\n\r\n#shiny-tab-about .col-sm-15 .box-body{\r\n  background-color:#d3d3d3; /* Light Grey */\r\n}\r\n\r\n#shiny-tab-about .col-sm-15 .box-header  h3{\r\n  font-family: \"Luminari\", fantasy;\r\n  font-size: 20px;\r\n  color:white;\r\n}\r\n","type":"text"}]
